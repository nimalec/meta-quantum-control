# Meta-RL for Quantum Control - Experiment Configuration

# Quantum System

psd_model: 'one_over_f'  # 'one_over_f', 'lorentzian', 'double_exp' (used if model_types not specified)
horizon: 1.0  # Total evolution time (arbitrary units)

psd_model: 'one_over_f'  # 'one_over_f', 'lorentzian', 'double_exp'
horizon: 0.00005  # Total evolution time (arbitrary units)

target_gate: 'pauli_x'  # 'hadamard', 'pauli_x', 'pauli_y'
omega0: 30000000
noise_type: 'frequency'



# Task Distribution
#(0.1, 4.0), "A": (100, 1e5), "omega_c": (0, 800) 
task_dist_type: 'uniform'


alpha_range: [0.5, 2.0]      # Spectral exponent range
A_range: [0.001, 0.01]         # FIXED: Increased to [0.01, 0.1] for better task diversity and meta-learning
omega_c_range: [100, 1000]    # Cutoff frequency range

# NEW: Mixed Model Sampling (comment out for single model mode)
# Uncomment to enable mixed model sampling across different PSD types
# model_types: ['one_over_f', 'lorentzian']  # List of model types to sample
# model_probs: [0.5, 0.5]  # Probabilities (must sum to 1.0). If omitted, uniform distribution

# Policy Network
task_feature_dim: 4  # NEW: Changed from 3 to 4 to include model_type encoding
hidden_dim: 64
n_hidden_layers: 1
n_segments: 20

alpha_range: [0.1, 4.0]      # Spectral exponent range
A_range: [100, 1e5]         # FIXED: Increased to [0.01, 0.1] for better task diversity and meta-learning
omega_c_range: [0, 800]    # Cutoff frequency range
# Policy Network
task_feature_dim: 3
hidden_dim: 256
n_hidden_layers: 2
n_segments: 100

n_controls: 2
output_scale: 2.0  # FIXED: Increased from 1.0 to allow stronger control signals for better gate fidelity
activation: 'tanh'
# MAML Hyperparameters
inner_lr: 0.01  # FIXED: Further reduced from 0.005 for stable gradients with differentiable simulator
inner_steps: 5   # FIXED: Increased from 3 to allow sufficient adaptation (meta-learning needs this!)
meta_lr: 0.001
first_order: true  # FIXED: Use FOMAML initially to avoid complex eigenvalue gradient issues

# Training
n_iterations: 55
tasks_per_batch: 32  # FIXED: Increased from 4 for more stable meta-gradient estimates
n_support: 8
n_query: 8
log_interval: 2
val_interval: 2
val_tasks: 32


# Checkpointing
save_dir: 'checkpoints'
