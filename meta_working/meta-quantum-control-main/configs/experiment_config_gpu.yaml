# Meta-RL for Quantum Control - GPU-Optimized Configuration
#
# This config is optimized for GPU training with:
# - Smaller batch sizes for faster processing
# - Larger time steps (dt) for speed
# - Fewer validation tasks
# - Balanced accuracy vs speed tradeoffs

# Random seed
seed: 42

# Quantum System
psd_model: 'one_over_f'  # 'one_over_f', 'lorentzian', 'double_exp'
horizon: 1.0  # Total evolution time (arbitrary units)
target_gate: 'pauli_x'  # 'hadamard', 'pauli_x', 'pauli_y'
num_qubits: 1  # Number of qubits (1 or 2)
drift_strength: 0.1  # Drift Hamiltonian strength

# Integration Settings (GPU-optimized)
integration_method: 'RK45'  # For non-differentiable simulation
dt_training: 0.02  # Time step for differentiable training (larger = faster)
use_rk4_training: false  # Use Euler for training (faster than RK4)

# Task Distribution
task_dist_type: 'uniform'

alpha_range: [0.5, 2.0]      # Spectral exponent range
A_range: [0.001, 0.01]       # Noise amplitude range
omega_c_range: [100, 1000]   # Cutoff frequency range

# Policy Network
task_feature_dim: 3
hidden_dim: 128
n_hidden_layers: 2
n_segments: 20
n_controls: 2
output_scale: 2.0  # Allow stronger control signals
activation: 'tanh'

# MAML Hyperparameters (GPU-optimized)
inner_lr: 0.01  # Inner loop learning rate
inner_steps: 5  # Fewer steps for faster training
meta_lr: 0.001  # Meta learning rate
first_order: true  # Use FOMAML for stability

# Training (GPU-optimized for speed)
n_iterations: 1000
tasks_per_batch: 16  # REDUCED: Smaller batches process faster on GPU
n_support: 2  # Support set size per task
n_query: 2  # Query set size per task
log_interval: 10  # Log more frequently
val_interval: 50  # Validate periodically
val_tasks: 20  # REDUCED: Fewer validation tasks for speed

# Checkpointing
save_dir: 'checkpoints_gpu'

# Robust Baseline (for comparison)
robust_type: 'minimax'  # 'average', 'minimax', 'cvar'
robust_iterations: 500
robust_tasks_per_batch: 16

# Optimality Gap Experiments
gap_n_samples: 50
gap_K_values: [1, 3, 5, 10]
gap_variance_range: [0.01, 0.05, 0.1, 0.2]
